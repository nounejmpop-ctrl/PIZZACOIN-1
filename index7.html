<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>–ü–∏—Ü—Ü–∞—à–æ–ø —Å –∫–æ–¥–∞–º–∏ 2.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root {
    --primary-color: #ffca28;
    --secondary-color: #ff6f00;
    --dark-bg: rgba(0,0,0,0.7);
    --item-bg: #222;
    --accent-shadow: #ffca28;
    --button-active-shadow: #cc5500;
  }

  @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');

  body {
    margin: 0;
    padding: 0;
    background: url('https://i.imgur.com/4Nk4Ewd.jpg') no-repeat center center fixed;
    background-size: cover;
    font-family: 'Fredoka One', cursive, Arial, sans-serif;
    color: #fff;
    text-align: center;
  }

  .overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: var(--dark-bg);
    z-index: -1;
  }

  h1 {
    margin-top: 40px;
    font-size: 3em;
    text-shadow: 2px 2px 6px #000;
  }

  #coins {
    color: var(--primary-color);
    text-shadow: 1px 1px 3px #000;
  }

  #coins::after {
    content: " üëî";
    display: inline-block;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .has-boss #coins::after {
    opacity: 1;
  }

  .has-king #coins::after {
    content: " üëë";
  }

  #addCoinBtn {
    margin: 20px auto 20px;
    padding: 20px 60px;
    font-size: 24px;
    font-weight: bold;
    background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
    border: none;
    border-radius: 12px;
    box-shadow: 0 5px var(--button-active-shadow);
    cursor: pointer;
    transition: all 0.1s ease;
    user-select: none;
  }

  #addCoinBtn:active {
    transform: translateY(4px);
    box-shadow: 0 1px var(--button-active-shadow);
  }

  #saveLoadButtons {
    margin: 0 auto 40px;
  }

  #saveLoadButtons button {
    padding: 10px 20px;
    font-size: 16px;
    background: #4a90e2;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    color: white;
    font-weight: bold;
    margin: 0 5px;
  }

  #shop {
    max-width: 500px;
    margin: 0 auto 20px;
    background: rgba(0,0,0,0.5);
    border-radius: 15px;
    padding: 20px;
  }

  .item {
    background: var(--item-bg);
    border-radius: 10px;
    margin: 10px 0;
    padding: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 0 8px var(--accent-shadow);
  }

  .item button {
    background: var(--primary-color);
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    color: #000;
    transition: background 0.3s ease;
  }

  .item button:disabled {
    background: #999;
    cursor: not-allowed;
  }

  #codeForm {
    max-width: 400px;
    margin: 0 auto 40px;
    background: rgba(0,0,0,0.6);
    padding: 15px 20px;
    border-radius: 15px;
    box-shadow: 0 0 10px var(--accent-shadow);
  }

  #codeInput {
    padding: 10px;
    width: 70%;
    font-size: 16px;
    border-radius: 8px;
    border: none;
  }

  #codeSubmit {
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    background: var(--primary-color);
    font-weight: bold;
    cursor: pointer;
    color: #000;
  }

  #message {
    margin-top: 10px;
    font-weight: bold;
    min-height: 24px;
  }

  footer {
    color: #ddd;
    font-size: 0.9em;
    margin-bottom: 20px;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è –±–∏—Ç–≤—ã */
  #battleUI {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.9);
    padding: 20px;
    border-radius: 15px;
    border: 3px solid #ff0000;
    z-index: 1000;
    text-align: center;
    width: 350px;
  }
  
  @media (max-width: 480px) {
    #battleUI {
      width: 90%;
      padding: 15px;
    }
  }

  #battleUI h2 {
    color: #ff5555;
    margin-top: 0;
  }

  #battleUI button {
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    font-weight: bold;
    cursor: pointer;
    margin: 5px;
    transition: transform 0.1s;
  }

  #attackBtn {
    background: #ff5555;
    color: white;
  }

  #healBtn {
    background: #4CAF50;
    color: white;
  }

  #battleLog {
    margin-top: 15px;
    height: 100px;
    overflow-y: auto;
    border: 1px solid #444;
    padding: 5px;
    text-align: left;
    font-size: 0.9em;
    font-family: Arial, sans-serif;
  }

  .health-bar-container {
    height: 20px;
    background: #555;
    margin-top: 5px;
    border-radius: 3px;
    overflow: hidden;
  }

  .health-bar {
    height: 100%;
    transition: width 0.3s;
  }

  #playerHealthBar {
    background: #4CAF50;
  }

  #enemyHealthBar {
    background: #f44336;
  }

  #battleButton {
    margin-top: 20px;
    padding: 15px 30px;
    background: linear-gradient(45deg, #ff3333, #cc0000);
    color: white;
    font-weight: bold;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    box-shadow: 0 4px #990000;
    transition: all 0.1s;
  }

  #battleButton:active {
    transform: translateY(2px);
    box-shadow: 0 2px #990000;
  }

  /* Earthbound-—Å—Ç–∏–ª—å */
  .critical-hit {
    animation: shake 0.5s;
    color: #ffcc00 !important;
    font-weight: bold;
  }

  @keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    50% { transform: translateX(5px); }
    75% { transform: translateX(-5px); }
    100% { transform: translateX(0); }
  }

  .battle-effect {
    position: absolute;
    font-size: 24px;
    animation: float-up 1s forwards;
  }

  @keyframes float-up {
    0% { opacity: 1; transform: translateY(0); }
    100% { opacity: 0; transform: translateY(-50px); }
  }
  
  .cheesy-mode h1 {
    color: yellow;
    text-shadow: 2px 2px 5px orange;
  }

  .cheesy-mode #addCoinBtn {
    background: linear-gradient(45deg, yellow, gold);
  }

  /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–æ—Ç–∞ –∏ –∏–≤–µ–Ω—Ç–æ–≤ */
  .lucky-cat {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 100px;
    cursor: pointer;
    animation: float 3s infinite ease-in-out;
    display: none;
  }
  
  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-15px); }
  }
  
  .event-notification {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 0, 0, 0.8);
    padding: 15px;
    border-radius: 10px;
    z-index: 1001;
    animation: pulse 1.5s infinite;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }
  
  @keyframes charge-up {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }
  
  .charge-animation {
    animation: charge-up 0.5s infinite;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
  .modal {
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.8);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    background: rgba(0,0,0,0.9);
    padding: 20px;
    border-radius: 10px;
    width: 80%;
    max-width: 400px;
    text-align: center;
  }

  .modal-content textarea, .modal-content input {
    width: calc(100% - 20px);
    padding: 10px;
    margin: 10px 0;
    border-radius: 5px;
    border: 1px solid #4a90e2;
    background: #333;
    color: white;
  }

  .modal-content button {
    padding: 10px 20px;
    background: #4a90e2;
    border: none;
    border-radius: 5px;
    color: white;
    cursor: pointer;
    margin: 5px;
  }
</style>
</head>
<body>

<div class="overlay"></div>

<h1>–ü–∏—Ü—Ü–∞–∫–æ–∏–Ω—ã: <span id="coins">0</span></h1>
<button id="addCoinBtn">–ü–æ–ª—É—á–∏—Ç—å –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω</button>

<div id="saveLoadButtons">
  <button id="saveBtn">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</button>
  <button id="loadBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</button>
</div>

<div id="shop">
  <h2>–ú–∞–≥–∞–∑–∏–Ω –∫–ª–∞—Å—Å–æ–≤</h2>
  <div class="item">
    <div>–ü–æ–≤–∞—Ä ‚Äî 100 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤</div>
    <button data-price="100" data-class="–ø–æ–≤–∞—Ä">–ö—É–ø–∏—Ç—å</button>
  </div>
  <div class="item">
    <div>–ö–∞—Å—Å–∏—Ä ‚Äî 150 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤</div>
    <button data-price="150" data-class="–∫–∞—Å—Å–∏—Ä">–ö—É–ø–∏—Ç—å</button>
  </div>
  <div class="item">
    <div>–î–æ—Å—Ç–∞–≤—â–∏–∫ ‚Äî 200 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤</div>
    <button data-price="200" data-class="–¥–æ—Å—Ç–∞–≤—â–∏–∫">–ö—É–ø–∏—Ç—å</button>
  </div>
  <div class="item">
    <div>–ë–æ—Å—Å ‚Äî 250 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤</div>
    <button data-price="250" data-class="–±–æ—Å—Å">–ö—É–ø–∏—Ç—å</button>
  </div>
  <div class="item">
    <div>–ö–æ—Ä–æ–ª—å –ø–∏—Ü—Ü—ã ‚Äî 300 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤</div>
    <button data-price="300" data-class="–∫–æ—Ä–æ–ª—å">–ö—É–ø–∏—Ç—å</button>
  </div>
  <div class="item">
    <div>–ü–∏—Ü—Ü–∞-–ù–∏–Ω–¥–∑—è ‚Äî 500 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤</div>
    <button data-price="500" data-class="–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è">–ö—É–ø–∏—Ç—å</button>
  </div>
  <div class="item">
    <div>–ö—É–ª–∏–Ω–∞—Ä–Ω—ã–π –ú–∞–≥ ‚Äî 600 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤</div>
    <button data-price="600" data-class="–∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –º–∞–≥">–ö—É–ø–∏—Ç—å</button>
  </div>
  <div class="item">
    <div>–§—É–¥-–ö—Ä–∏—Ç–∏–∫ ‚Äî 400 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤</div>
    <button data-price="400" data-class="—Ñ—É–¥-–∫—Ä–∏—Ç–∏–∫">–ö—É–ø–∏—Ç—å</button>
  </div>
  <button id="battleButton">–ë–∏—Ç–≤–∞ —Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º–∏</button>
</div>

<div id="codeForm">
  <h2>–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥</h2>
  <input type="text" id="codeInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥..." />
  <button id="codeSubmit">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
  <div id="message"></div>
</div>

<img id="luckyCat" class="lucky-cat" src="https://i.imgur.com/J5Q8a0j.png" title="–ö–æ—Ç —É–¥–∞—á–∏! –ö–ª–∏–∫–Ω–∏ –¥–ª—è –º–æ–Ω–µ—Ç">

<footer>
  <div>–ö—É–ø–ª–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã: <span id="ownedClasses">–Ω–µ—Ç</span></div>
  <div>–°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ä–æ–ª–∏: <span id="secretRoles">–Ω–µ—Ç</span></div>
</footer>

<div id="saveModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h3>–¢–≤–æ–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</h3>
    <textarea id="saveCodeArea" rows="5" readonly></textarea>
    <button id="copySaveCodeBtn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    <button id="closeSaveModalBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<div id="loadModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h3>–í—Å—Ç–∞–≤—å –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</h3>
    <input type="text" id="loadCodeInput" placeholder="–í—Å—Ç–∞–≤—å –∫–æ–¥ —Å—é–¥–∞..." />
    <button id="applyLoadCodeBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
    <button id="closeLoadModalBtn">–û—Ç–º–µ–Ω–∞</button>
  </div>
</div>

<audio id="clickSound" src="https://freesound.org/data/previews/64/64501_634166-lq.mp3"></audio>
<audio id="bgMusic" src="https://pizza-coin-mus.edgeone.app/08.%20Good%20Morning%20Pizzeria.mp3" loop></audio>
<audio id="battleSound" src="https://freesound.org/data/previews/511/511919_919539-lq.mp3"></audio>
<audio id="winSound" src="https://freesound.org/data/previews/467/467390_8437853-lq.mp3"></audio>
<audio id="luigiSound" src="https://www.myinstants.com/media/sounds/mamma-mia-luigi.mp3"></audio>

<script>
  // =====================
  // –û–°–ù–û–í–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
  // =====================
  let coins, ownedClasses, secretRoles, usedCodes;
  const clickSound = document.getElementById('clickSound');
  const luigiSound = document.getElementById('luigiSound');
  const messageEl = document.getElementById('message');
  let currentClickSound = clickSound;
  
  // –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Base64
  function encode(str) {
      return btoa(unescape(encodeURIComponent(str)));
  }
  
  function decode(str) {
      try {
          return decodeURIComponent(escape(atob(str)));
      } catch (e) {
          console.error("–û—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è", e);
          return null;
      }
  }

  function loadData() {
    try {
      coins = parseInt(localStorage.getItem('pizzacoins')) || 0;
      ownedClasses = JSON.parse(localStorage.getItem('ownedClasses')) || [];
      secretRoles = JSON.parse(localStorage.getItem('secretRoles')) || [];
      usedCodes = JSON.parse(localStorage.getItem('usedCodes')) || [];
    } catch (e) {
      console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:", e);
      coins = 0;
      ownedClasses = [];
      secretRoles = [];
      usedCodes = [];
    }
  }
  
  function saveData() {
    localStorage.setItem('pizzacoins', coins);
    localStorage.setItem('ownedClasses', JSON.stringify(ownedClasses));
    localStorage.setItem('secretRoles', JSON.stringify(secretRoles));
    localStorage.setItem('usedCodes', JSON.stringify(usedCodes));
  }

  let autoClickerIntervals = {};
  let luckyCatActive = false;
  let eventActive = false;
  let autoClickersDisabled = false;

  // –ë–∏—Ç–≤–∞
  let isBattleActive = false;
  let battleInterval = null;
  let battleHealth = 100;
  let battleEnemyHealth = 100;
  let currentEnemy = "";
  let enemyAttackInterval = 3000;
  let isCriticalHit = false;

  const battleRewards = {
    "–ë—É—Ä–≥–µ—Ä-–ì–∞–Ω–≥—Å—Ç–µ—Ä": 50,
    "–°—É—à–∏-–†–æ–±–æ—Ç": 80,
    "–ö—Ä–∞–∫–µ–Ω-–ö–∞–ª—å–º–∞—Ä": 120,
    "–ë–æ—Å—Å –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤": 200
  };

  const enemies = [
    { name: "–ë—É—Ä–≥–µ—Ä-–ì–∞–Ω–≥—Å—Ç–µ—Ä", hp: 120, attack: "–∫–µ—Ç—á—É–ø–æ–º", weakness: null },
    { name: "–°—É—à–∏-–†–æ–±–æ—Ç", hp: 150, attack: "—Ä—ã–±–Ω—ã–º –Ω–æ–∂–æ–º", weakness: "–∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –º–∞–≥" },
    { name: "–ö—Ä–∞–∫–µ–Ω-–ö–∞–ª—å–º–∞—Ä", hp: 200, attack: "—â—É–ø–∞–ª—å—Ü–∞–º–∏", weakness: "–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è" },
    { name: "–ë–æ—Å—Å –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤", hp: 300, attack: "–Ω–µ—á–µ—Å—Ç–Ω—ã–º–∏ –ø—Ä–∏—ë–º–∞–º–∏", weakness: null }
  ];

  // –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM
  const coinsEl = document.getElementById('coins');
  const btn = document.getElementById('addCoinBtn');
  const battleSound = document.getElementById('battleSound');
  const winSound = document.getElementById('winSound');
  const ownedEl = document.getElementById('ownedClasses');
  const secretRolesEl = document.getElementById('secretRoles');
  const shopButtons = document.querySelectorAll('#shop button');
  const codeInput = document.getElementById('codeInput');
  const codeSubmit = document.getElementById('codeSubmit');
  const battleButton = document.getElementById('battleButton');
  const saveBtn = document.getElementById('saveBtn');
  const loadBtn = document.getElementById('loadBtn');
  const saveModal = document.getElementById('saveModal');
  const loadModal = document.getElementById('loadModal');
  const saveCodeArea = document.getElementById('saveCodeArea');
  const copySaveCodeBtn = document.getElementById('copySaveCodeBtn');
  const closeSaveModalBtn = document.getElementById('closeSaveModalBtn');
  const loadCodeInput = document.getElementById('loadCodeInput');
  const applyLoadCodeBtn = document.getElementById('applyLoadCodeBtn');
  const closeLoadModalBtn = document.getElementById('closeLoadModalBtn');

  // =====================
  // –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò 2.0
  // =====================
  function playSound(sound) {
    if (sound) {
      sound.currentTime = 0;
      sound.play().catch(e => console.log(`–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫ ${sound.id}:`, e));
    }
  }

  // –ö–æ—Ç —É–¥–∞—á–∏
  function startLuckyCatTimer() {
    setInterval(() => {
      if (luckyCatActive && !eventActive) {
        coins += 10;
        showMessage("–ö–æ—Ç —É–¥–∞—á–∏ –ø—Ä–∏–Ω—ë—Å –≤–∞–º 10 –º–æ–Ω–µ—Ç!");
        updateDisplay();
      }
    }, 300000); // 5 –º–∏–Ω—É—Ç
  }

  // –°–∏—Å—Ç–µ–º–∞ –∏–≤–µ–Ω—Ç–æ–≤
  function checkForEvents() {
    if (ownedClasses.includes('–±–æ—Å—Å') && Math.random() < 0.2 && !eventActive) {
      startRandomEvent();
    }
  }

  function startRandomEvent() {
    eventActive = true;
    const events = [
      bossBattleEvent,
      stealWorkersEvent
    ];
    events[Math.floor(Math.random() * events.length)]();
  }

  function bossBattleEvent() {
    showEventNotification("–ë–û–°–° –ö–û–ù–ö–£–†–ï–ù–¢–û–í –ê–¢–ê–ö–£–ï–¢! –ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ —Ç—è–∂—ë–ª–æ–π –±–∏—Ç–≤–µ!");
    
    currentEnemy = "–ë–æ—Å—Å –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤";
    battleEnemyHealth = 300;
    enemyAttackInterval = 2000;
    startBattleLogic();
  }

  function stealWorkersEvent() {
    showEventNotification("–ë–æ—Å—Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –ø–æ—Ö–∏—Ç–∏–ª –≤–∞—à–∏—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤! –ë—ã—Å—Ç—Ä–æ –∑–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ 50 –º–æ–Ω–µ—Ç –±–µ–∑ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–æ–≤!");
    
    autoClickersDisabled = true;
    clearAllAutoClickers();
    
    let timer = 60;
    const countdown = setInterval(() => {
      timer--;
      if (timer <= 0) {
        clearInterval(countdown);
        failStealEvent();
      }
    }, 1000);
    
    const originalCoins = coins;
    const checkInterval = setInterval(() => {
      if (coins >= originalCoins + 50) {
        clearInterval(countdown);
        clearInterval(checkInterval);
        successStealEvent();
      }
    }, 100);
  }

  function successStealEvent() {
    showMessage("–í—ã —Å–ø–∞—Å–ª–∏ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤! +100 –º–æ–Ω–µ—Ç –±–æ–Ω—É—Å–∞!");
    coins += 100;
    autoClickersDisabled = false;
    restartAutoClickers();
    eventActive = false;
  }

  function failStealEvent() {
    showMessage("–†–∞–±–æ—Ç–Ω–∏–∫–∏ —É—à–ª–∏ –∫ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º... –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã –Ω–∞ 5 –º–∏–Ω—É—Ç!");
    setTimeout(() => {
      autoClickersDisabled = false;
      restartAutoClickers();
      eventActive = false;
    }, 300000);
  }

  function clearAllAutoClickers() {
    for (const key in autoClickerIntervals) {
      clearInterval(autoClickerIntervals[key]);
    }
    autoClickerIntervals = {};
  }

  function restartAutoClickers() {
    if (ownedClasses.includes('–±–æ—Å—Å')) startAutoClicker('–±–æ—Å—Å', 3, 20000, "–í–∞—à–∏ —Ä–∞–±–æ—Ç–Ω–∏–∫–∏ –ø—Ä–∏–Ω–µ—Å–ª–∏ 3 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–∞!");
    if (ownedClasses.includes('–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è')) startAutoClicker('–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è', 5, 1000, "–ü–∏—Ü—Ü–∞-–ù–∏–Ω–¥–∑—è —É–∫—Ä–∞–ª 5 –º–æ–Ω–µ—Ç!", 0.1);
    if (ownedClasses.includes('–∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –º–∞–≥')) startAutoClicker('–∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –º–∞–≥', 5, 15000, "–ö—É–ª–∏–Ω–∞—Ä–Ω—ã–π –ú–∞–≥ —Å–æ–∑–¥–∞–ª 5 –º–æ–Ω–µ—Ç!");
    if (ownedClasses.includes('–¥—Ä–∞–∫–æ–Ω –ø–∏—Ü—Ü—ã')) startAutoClicker('–¥—Ä–∞–∫–æ–Ω –ø–∏—Ü—Ü—ã', 1, 1000, null);
  }

  function showEventNotification(text) {
    const notification = document.createElement('div');
    notification.className = 'event-notification';
    notification.textContent = text;
    document.body.appendChild(notification);
    setTimeout(() => notification.remove(), 5000);
  }

  // =====================
  // –û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
  // =====================

  // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
  function startAutoClicker(className, amount, interval, message, chance = 1) {
    if (autoClickerIntervals[className]) clearInterval(autoClickerIntervals[className]);
    autoClickerIntervals[className] = setInterval(() => {
      if (!autoClickersDisabled && Math.random() < chance) {
        coins += amount;
        if (message) showMessage(message);
        updateDisplay();
      }
    }, interval);
  }

  // –§—É–Ω–∫—Ü–∏–∏ –±–∏—Ç–≤—ã
  function startBattle() {
    if (!ownedClasses.includes('–±–æ—Å—Å') && !ownedClasses.includes('–∫–æ—Ä–æ–ª—å') && 
        !ownedClasses.includes('–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è') && !ownedClasses.includes('–∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –º–∞–≥')) {
      showMessage("–ù—É–∂–µ–Ω –±–æ–µ–≤–æ–π –∫–ª–∞—Å—Å (–ë–æ—Å—Å/–ö–æ—Ä–æ–ª—å/–ù–∏–Ω–¥–∑—è/–ú–∞–≥)!");
      return;
    }

    // –í—ã–±–æ—Ä –≤—Ä–∞–≥–∞
    let enemy;
    const isKing = ownedClasses.includes('–∫–æ—Ä–æ–ª—å');
    
    if (isKing && Math.random() < 0.1) {
      enemy = enemies[2]; // –ö—Ä–∞–∫–µ–Ω-–ö–∞–ª—å–º–∞—Ä
    } else if (Math.random() < 0.3) {
      enemy = enemies[1]; // –°—É—à–∏-–†–æ–±–æ—Ç
    } else {
      enemy = enemies[0]; // –ë—É—Ä–≥–µ—Ä-–ì–∞–Ω–≥—Å—Ç–µ—Ä
    }
    
    currentEnemy = enemy.name;
    battleEnemyHealth = enemy.hp;
    enemyAttackInterval = 3000 - (ownedClasses.includes('—Ñ—É–¥-–∫—Ä–∏—Ç–∏–∫') ? 500 : 0);
    
    startBattleLogic();
  }
  
  function startBattleLogic() {
    isBattleActive = true;
    battleHealth = 100;
    
    const battleUI = document.createElement('div');
    battleUI.id = 'battleUI';
    battleUI.innerHTML = `
      <h2>–ë–ò–¢–í–ê –° ${currentEnemy.toUpperCase()}!</h2>
      <div style="display: flex; justify-content: space-between; margin: 20px 0">
        <div>
          <div>–í–ê–®–ï –ó–î–û–†–û–í–¨–ï: <span id="playerHealth">100</span></div>
          <div class="health-bar-container">
            <div id="playerHealthBar" class="health-bar" style="width: 100%"></div>
          </div>
        </div>
        <div>
          <div>${currentEnemy.toUpperCase()}: <span id="enemyHealth">${battleEnemyHealth}</span></div>
          <div class="health-bar-container">
            <div id="enemyHealthBar" class="health-bar" style="width: 100%"></div>
          </div>
        </div>
      </div>
      <button id="attackBtn">–ê–¢–ê–ö–û–í–ê–¢–¨</button>
      <button id="healBtn">–õ–ï–ß–ò–¢–¨–°–Ø</button>
      <div id="battleLog"></div>
    `;
    
    document.body.appendChild(battleUI);
    playSound(battleSound);
    
    document.getElementById('attackBtn').addEventListener('mousedown', startCharge);
    document.getElementById('healBtn').addEventListener('mousedown', startCharge);

    battleInterval = setInterval(enemyAttack, enemyAttackInterval);
  }

  let chargeState = {
      isCharging: false,
      button: null,
      charge: 1,
      interval: null
  };
  
  function startCharge(e) {
      if (chargeState.isCharging) return;
      
      chargeState.isCharging = true;
      chargeState.button = e.target;
      chargeState.charge = 1;
      
      chargeState.button.classList.add('charge-animation');

      chargeState.interval = setInterval(() => {
          chargeState.charge = Math.min(chargeState.charge + 0.1, 2.5);
      }, 100);

      const endCharge = () => {
          if (!chargeState.isCharging) return;
          clearInterval(chargeState.interval);
          chargeState.isCharging = false;
          chargeState.button.classList.remove('charge-animation');
          
          if (chargeState.button.id === 'attackBtn') {
              executeAttack(chargeState.charge);
          } else {
              executeHeal(chargeState.charge);
          }

          document.removeEventListener('mouseup', endCharge);
      };

      document.addEventListener('mouseup', endCharge);
  }

  function executeAttack(charge) {
    if (!isBattleActive) return;
    
    let damage = 30;
    let isCriticalHit = Math.random() < 0.2;
    
    if (ownedClasses.includes('–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è') && Math.random() < 0.3) {
      addBattleLog("–ü–∏—Ü—Ü–∞-–ù–∏–Ω–¥–∑—è —É–∫–ª–æ–Ω–∏–ª—Å—è –æ—Ç –∞—Ç–∞–∫–∏!", "#55ff55");
      return;
    }
    
    damage = Math.round(damage * charge);
    if (isCriticalHit) {
      damage = Math.round(damage * 1.5);
      addBattleLog("–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –£–î–ê–†!", "#ffcc00");
      createBattleEffect("CRITICAL!", "#ffcc00", "enemyHealth");
    }
    
    const enemy = enemies.find(e => e.name === currentEnemy);
    if (enemy && enemy.weakness && ownedClasses.includes(enemy.weakness)) {
      damage = Math.round(damage * 2);
      addBattleLog(`–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ! (${enemy.weakness.toUpperCase()} ‚Äî —Å–ª–∞–±–æ—Å—Ç—å ${currentEnemy})`, "#55ff55");
    }
    
    battleEnemyHealth -= damage;
    if (battleEnemyHealth < 0) battleEnemyHealth = 0;
    
    updateBattleUI();
    addBattleLog(`–í—ã –∞—Ç–∞–∫–æ–≤–∞–ª–∏ –∏ –Ω–∞–Ω–µ—Å–ª–∏ ${damage} —É—Ä–æ–Ω–∞!`, "#ff5555");
    createBattleEffect(`-${damage}`, "#ff5555", "enemyHealth");
    
    if (battleEnemyHealth <= 0) {
      winBattle();
    }
  }

  function executeHeal(charge) {
    if (!isBattleActive) return;
    
    let heal = Math.round(20 * charge);
    battleHealth += heal;
    if (battleHealth > 100) battleHealth = 100;
    
    updateBattleUI();
    addBattleLog(`–í—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ ${heal} –∑–¥–æ—Ä–æ–≤—å—è!`, "#55ff55");
    createBattleEffect(`+${heal}`, "#55ff55", "playerHealth");
  }

  function enemyAttack() {
    if (!isBattleActive) return;
    
    const enemy = enemies.find(e => e.name === currentEnemy);
    let damage = 10 + Math.floor(Math.random() * 20);
    
    const attackPhrases = [
      `${currentEnemy} –∞—Ç–∞–∫–æ–≤–∞–ª ${enemy.attack} –∏ –Ω–∞–Ω–µ—Å ${damage} —É—Ä–æ–Ω–∞!`,
      `${currentEnemy} —É–¥–∞—Ä–∏–ª ${enemy.attack} (${damage} —É—Ä–æ–Ω–∞)!`,
      `–ê—Ç–∞–∫–∞ ${currentEnemy}: ${damage} —É—Ä–æ–Ω–∞!`
    ];
    
    battleHealth -= damage;
    if (battleHealth < 0) battleHealth = 0;
    
    updateBattleUI();
    addBattleLog(attackPhrases[Math.floor(Math.random() * attackPhrases.length)], "#ff5555");
    createBattleEffect(`-${damage}`, "#ff5555", "playerHealth");
    
    if (battleHealth <= 0) {
      loseBattle();
    }
  }

  function createBattleEffect(text, color, target) {
    const effect = document.createElement('div');
    effect.className = 'battle-effect';
    effect.textContent = text;
    effect.style.color = color;
    
    const targetEl = document.getElementById(target);
    const rect = targetEl.getBoundingClientRect();
    const battleUIRect = document.getElementById('battleUI').getBoundingClientRect();
    
    effect.style.left = `${rect.left + rect.width / 2 - battleUIRect.left}px`;
    effect.style.top = `${rect.top - battleUIRect.top}px`;
    
    document.getElementById('battleUI').appendChild(effect);
    
    setTimeout(() => effect.remove(), 1000);
  }

  function updateBattleUI() {
    if (!isBattleActive) return;
    
    document.getElementById('playerHealth').textContent = battleHealth;
    document.getElementById('enemyHealth').textContent = battleEnemyHealth;
    document.getElementById('playerHealthBar').style.width = `${battleHealth}%`;
    document.getElementById('enemyHealthBar').style.width = `${battleEnemyHealth / (enemies.find(e => e.name === currentEnemy).hp) * 100}%`;
  }

  function addBattleLog(message, color) {
    const log = document.getElementById('battleLog');
    const entry = document.createElement('div');
    entry.textContent = message;
    entry.style.color = color || '#fff';
    log.appendChild(entry);
    log.scrollTop = log.scrollHeight;
  }

  function winBattle() {
    clearInterval(battleInterval);
    isBattleActive = false;
    addBattleLog(`–ü–û–ë–ï–î–ê! –í—ã –ø–æ–±–µ–¥–∏–ª–∏ ${currentEnemy}!`, "#ffcc00");
    playSound(winSound);
    
    const reward = battleRewards[currentEnemy] || 150;
    coins += reward;
    updateDisplay();
    
    setTimeout(() => {
      document.getElementById('battleUI')?.remove();
      showMessage(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${reward} –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤ –∑–∞ –ø–æ–±–µ–¥—É!`);
    }, 3000);
  }

  function loseBattle() {
    clearInterval(battleInterval);
    isBattleActive = false;
    addBattleLog(`–ü–û–†–ê–ñ–ï–ù–ò–ï! ${currentEnemy} –ø–æ–±–µ–¥–∏–ª...`, "#ff5555");
    
    let penalty = 50;
    const enemy = enemies.find(e => e.name === currentEnemy);
    if (enemy) {
      penalty = enemy.hp / 3;
    }
    
    setTimeout(() => {
      document.getElementById('battleUI')?.remove();
      showMessage(`${currentEnemy} —É–∫—Ä–∞–ª ${Math.round(penalty)} –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤...`);
      coins = Math.max(0, coins - Math.round(penalty));
      updateDisplay();
    }, 3000);
  }

  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  function showMessage(text) {
    messageEl.textContent = text;
    setTimeout(() => messageEl.textContent = '', 3000);
  }

  function updateDisplay() {
    coinsEl.textContent = coins;
    document.body.classList.toggle('has-boss', ownedClasses.includes('–±–æ—Å—Å'));
    document.body.classList.toggle('has-king', ownedClasses.includes('–∫–æ—Ä–æ–ª—å'));
    updateShopButtons();
    updateOwnedClasses();
    updateSecretRoles();
    saveData();
  }

  function updateShopButtons() {
    shopButtons.forEach(button => {
      const price = parseInt(button.dataset.price);
      const className = button.dataset.class;
      if (ownedClasses.includes(className)) {
        button.textContent = '–ö—É–ø–ª–µ–Ω–æ';
        button.disabled = true;
      } else if (coins < price) {
        button.disabled = true;
      } else {
        button.disabled = false;
        button.textContent = '–ö—É–ø–∏—Ç—å';
      }
    });
  }

  function updateOwnedClasses() {
    ownedEl.textContent = ownedClasses.length ? ownedClasses.join(', ') : '–Ω–µ—Ç';
  }

  function updateSecretRoles() {
    secretRolesEl.textContent = secretRoles.length ? secretRoles.join(', ') : '–Ω–µ—Ç';
  }

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
  btn.addEventListener('click', () => {
    let coinGain = 1;
    
    if (ownedClasses.includes('–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è') && Math.random() < 0.1) {
      coinGain = 5;
      showMessage("–ü–∏—Ü—Ü–∞-–ù–∏–Ω–¥–∑—è –ø–æ–º–æ–≥ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –±–æ–ª—å—à–µ!");
    }
    
    coins += coinGain;
    updateDisplay();
    playSound(currentClickSound);
  });

  shopButtons.forEach(button => {
    button.addEventListener('click', (e) => {
      const price = parseInt(e.target.dataset.price);
      const className = e.target.dataset.class;
      
      if (coins >= price && !ownedClasses.includes(className)) {
        coins -= price;
        ownedClasses.push(className);
        
        if (className === '–±–æ—Å—Å') startAutoClicker('–±–æ—Å—Å', 3, 20000, "–í–∞—à–∏ —Ä–∞–±–æ—Ç–Ω–∏–∫–∏ –ø—Ä–∏–Ω–µ—Å–ª–∏ 3 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–∞!");
        if (className === '–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è') startAutoClicker('–ø–∏—Ü—Ü–∞-–Ω–∏–Ω–¥–∑—è', 5, 1000, "–ü–∏—Ü—Ü–∞-–ù–∏–Ω–¥–∑—è —É–∫—Ä–∞–ª 5 –º–æ–Ω–µ—Ç!", 0.1);
        if (className === '–∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –º–∞–≥') startAutoClicker('–∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –º–∞–≥', 5, 15000, "–ö—É–ª–∏–Ω–∞—Ä–Ω—ã–π –ú–∞–≥ —Å–æ–∑–¥–∞–ª 5 –º–æ–Ω–µ—Ç!");
        if (className === '—Ñ—É–¥-–∫—Ä–∏—Ç–∏–∫') showMessage("–¢–µ–ø–µ—Ä—å –≤—Ä–∞–≥–∏ –∞—Ç–∞–∫—É—é—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ!");
        
        updateDisplay();
        playSound(currentClickSound);
      }
    });
  });

  battleButton.addEventListener('click', startBattle);

  // –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏
  saveBtn.addEventListener('click', () => {
    const saveDataObj = { coins, ownedClasses, secretRoles, usedCodes };
    const jsonString = JSON.stringify(saveDataObj);
    const saveCode = encode(jsonString);
    saveCodeArea.value = saveCode;
    saveModal.style.display = 'flex';
  });

  loadBtn.addEventListener('click', () => {
    loadModal.style.display = 'flex';
  });

  closeSaveModalBtn.addEventListener('click', () => {
    saveModal.style.display = 'none';
  });

  closeLoadModalBtn.addEventListener('click', () => {
    loadModal.style.display = 'none';
  });
  
  copySaveCodeBtn.addEventListener('click', () => {
      saveCodeArea.select();
      document.execCommand('copy');
      showMessage("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!");
  });

  applyLoadCodeBtn.addEventListener('click', () => {
    const loadCode = loadCodeInput.value.trim();
    if (loadCode) {
      const jsonString = decode(loadCode);
      if (jsonString) {
        try {
          const loadedData = JSON.parse(jsonString);
          if (loadedData.coins !== undefined && loadedData.ownedClasses !== undefined) {
            coins = loadedData.coins;
            ownedClasses = loadedData.ownedClasses;
            secretRoles = loadedData.secretRoles;
            usedCodes = loadedData.usedCodes;
            
            clearAllAutoClickers();
            restartAutoClickers();
            
            updateDisplay();
            showMessage("–ü—Ä–æ–≥—Ä–µ—Å—Å —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!");
            loadModal.style.display = 'none';
          } else {
            showMessage("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.");
          }
        } catch (e) {
          console.error("–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON", e);
          showMessage("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.");
        }
      } else {
        showMessage("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.");
      }
    } else {
      showMessage("–ü–æ–ª–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º.");
    }
  });


  // –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–æ–¥—ã
  const codes = {
    'FREE100': () => {
      coins += 100;
      messageEl.textContent = '–í—ã –ø–æ–ª—É—á–∏–ª–∏ 100 –ø–∏—Ü—Ü–∞–∫–æ–∏–Ω–æ–≤!';
    },
    'ADMINROLE': () => {
      if (!secretRoles.includes('–∞–¥–º–∏–Ω')) {
        secretRoles.push('–∞–¥–º–∏–Ω');
        messageEl.textContent = '–í–∞–º –ø—Ä–∏—Å–≤–æ–µ–Ω–∞ —Ä–æ–ª—å "–∞–¥–º–∏–Ω"!';
      }
    },
    'OVERLORD': () => {
      if (!secretRoles.includes('—Å–≤–µ—Ä—Ö–≤–ª–∞–¥—ã–∫–∞')) {
        secretRoles.push('—Å–≤–µ—Ä—Ö–≤–ª–∞–¥—ã–∫–∞');
        messageEl.textContent = '–í—ã ‚Äî –°–≤–µ—Ä—Ö–≤–ª–∞–¥—ã–∫–∞!';
      }
    },
    'PEPPERONI': () => {
      coins += 50;
      const randomClasses = ['–ø–æ–≤–∞—Ä', '–∫–∞—Å—Å–∏—Ä', '–¥–æ—Å—Ç–∞–≤—â–∏–∫'];
      const randomClass = randomClasses[Math.floor(Math.random() * randomClasses.length)];
      if (!ownedClasses.includes(randomClass)) {
        ownedClasses.push(randomClass);
      }
      messageEl.textContent = `–í—ã –ø–æ–ª—É—á–∏–ª–∏ 50 –º–æ–Ω–µ—Ç –∏ –∫–ª–∞—Å—Å ${randomClass}!`;
    },
    'GARLICBREAD': () => {
      if (!secretRoles.includes('—á–µ—Å–Ω–æ—á–Ω—ã–π —Ö–ª–µ–±')) {
        secretRoles.push('—á–µ—Å–Ω–æ—á–Ω—ã–π —Ö–ª–µ–±');
        messageEl.textContent = '–í—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ —Å–∫—Ä—ã—Ç—É—é –∫–Ω–æ–ø–∫—É!';
      }
    },
    'CHEESY': () => {
      document.body.classList.add('cheesy-mode');
      messageEl.textContent = '–†–µ–∂–∏–º —Å—ã—Ä–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!';
    },
    'MAMMA MIA': () => {
      currentClickSound = luigiSound;
      messageEl.textContent = '–¢–µ–ø–µ—Ä—å –∑–≤—É–∫–∏ –∫–ª–∏–∫–æ–≤ ‚Äî —ç—Ç–æ –õ—É–∏–¥–∂–∏!';
    },
    'HOTSAUCE': () => {
      if (!ownedClasses.includes('–¥—Ä–∞–∫–æ–Ω –ø–∏—Ü—Ü—ã')) {
        ownedClasses.push('–¥—Ä–∞–∫–æ–Ω –ø–∏—Ü—Ü—ã');
        messageEl.textContent = '–í—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ –î—Ä–∞–∫–æ–Ω–∞ –ü–∏—Ü—Ü—ã!';
        startAutoClicker('–¥—Ä–∞–∫–æ–Ω –ø–∏—Ü—Ü—ã', 1, 1000);
      }
    },
    'INSPECTME': () => {
      coins += 500;
      messageEl.textContent = '–í—ã –Ω–∞—à–ª–∏ —Å–∫—Ä—ã—Ç—ã–π –∫–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏! +500 –º–æ–Ω–µ—Ç!';
    },
    'CATS': () => {
      document.getElementById('luckyCat').style.display = 'block';
      luckyCatActive = true;
      startLuckyCatTimer();
      messageEl.textContent = '–ö–æ—Ç —É–¥–∞—á–∏ —Ç–µ–ø–µ—Ä—å —Å –≤–∞–º–∏! –û–Ω –ø—Ä–∏–Ω–æ—Å–∏—Ç –º–æ–Ω–µ—Ç—ã –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç.';
    }
  };

  codeSubmit.addEventListener('click', () => {
    const code = codeInput.value.trim().toUpperCase();
    
    if (usedCodes.includes(code)) {
      messageEl.textContent = '–ö–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω!';
    } else if (codes[code]) {
      codes[code]();
      usedCodes.push(code);
      updateDisplay();
      playSound(currentClickSound);
      codeInput.value = '';
    } else {
      messageEl.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!';
    }
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  window.addEventListener('load', () => {
    loadData();
    
    document.body.addEventListener('click', () => {
      const bgMusic = document.getElementById('bgMusic');
      bgMusic.volume = 0.3;
      bgMusic.play().catch(e => console.log("–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –º—É–∑—ã–∫—É:", e));
    }, { once: true });
    
    restartAutoClickers();
    setInterval(checkForEvents, 600000); 
    updateDisplay();
  });

  document.getElementById('luckyCat').addEventListener('click', () => {
    coins += 5;
    showMessage("–í—ã –ø–æ–≥–ª–∞–¥–∏–ª–∏ –∫–æ—Ç–∞ +5 –º–æ–Ω–µ—Ç!");
    updateDisplay();
    playSound(currentClickSound);
  });

  console.log("–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥: INSPECTME");
</script>
</body>
</html>
